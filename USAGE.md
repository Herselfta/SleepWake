# SleepWake 使用说明

## 📋 目录
- [快速开始](#快速开始)
- [详细功能](#详细功能)
- [高级用法](#高级用法)
- [故障排除](#故障排除)
- [常见问题](#常见问题)

## 🚀 快速开始

### 首次使用

1. **运行安装脚本**
   ```powershell
   # 以管理员身份运行PowerShell
   .\setup.ps1
   ```

2. **启动程序**
   - 双击桌面快捷方式
   - 或在开始菜单找到"SleepWake"

3. **设置唤醒时间**
   - 选择 `1`：30分钟后唤醒
   - 选择 `2`：2小时后唤醒
   - 选择 `3`：明天8:30唤醒

4. **选择睡眠模式**
   - 选择 `1`：睡眠模式（推荐）
   - 选择 `2`：休眠模式（警告）

## 📖 详细功能

### 时间设置选项

#### 1. 分钟级唤醒
```
选择: 1
输入: 30
结果: 30分钟后唤醒
```

#### 2. 小时级唤醒
```
选择: 2
输入: 1.5
结果: 1.5小时后唤醒
```

#### 3. 具体时间唤醒
```
选择: 3
输入: 08:30
结果: 明天8:30唤醒

选择: 3
输入: 2025-01-15 08:30
结果: 2025年1月15日8:30唤醒
```

### 管理功能

#### 4. 取消唤醒任务
```
选择: 4
结果: 删除当前唤醒任务
```

#### 5. 查看任务状态
```
选择: 5
显示:
- 任务描述
- 唤醒时间
- 剩余时间
- 唤醒功能状态
- 当前唤醒定时器
```

#### 6. 系统诊断
```
选择: 6
检查:
- 支持的睡眠状态
- 当前唤醒定时器
- 支持唤醒的设备
- 系统配置建议
```

## 🔧 高级用法

### 命令行参数

虽然主脚本是交互式的，但您可以通过修改脚本来支持命令行参数：

```powershell
# 示例：30分钟后唤醒并进入睡眠
.\WakeAfter.ps1 -Minutes 30 -SleepMode Sleep

# 示例：明天8:30唤醒
.\WakeAfter.ps1 -Time "08:30" -SleepMode Sleep
```

### 自动化脚本

您可以创建批处理文件来自动化使用：

```batch
@echo off
echo 设置30分钟后唤醒...
powershell.exe -NoProfile -ExecutionPolicy Bypass -File "C:\SleepWake\WakeAfter.ps1"
```

### 任务计划集成

脚本会自动创建Windows任务计划，您也可以在任务计划程序中查看和管理：

1. 打开"任务计划程序"
2. 查找"SystemAutoWake"任务
3. 可以手动运行、编辑或删除

## 🔧 故障排除

### 无法唤醒

**症状**：设置了唤醒时间但电脑没有按时唤醒

**解决方案**：
1. 运行系统诊断（选项6）
2. 检查BIOS中的RTC Alarm设置
3. 确保使用睡眠模式而非休眠
4. 检查电源管理设置

### 权限错误

**症状**：提示权限不足或无法创建任务

**解决方案**：
1. 确保以管理员身份运行
2. 检查UAC设置
3. 手动运行：右键PowerShell → "以管理员身份运行"

### Docker环境问题

**症状**：Docker环境下无法正常唤醒

**解决方案**：
1. 使用睡眠模式（选项1）
2. 避免使用休眠模式
3. 检查Hyper-V设置
4. 禁用混合睡眠

## ❓ 常见问题

### Q: 脚本支持哪些Windows版本？
A: 支持Windows 10和Windows 11，需要PowerShell 5.1或更高版本。

### Q: 为什么推荐睡眠模式而不是休眠？
A: 睡眠模式唤醒更可靠，特别是在Docker/Hyper-V环境下。休眠模式可能无法被定时器唤醒。

### Q: 可以设置重复唤醒吗？
A: 当前版本不支持重复唤醒，每次需要重新设置。重复唤醒功能在计划中。

### Q: 唤醒后会执行什么操作？
A: 唤醒后会播放提示音（两声蜂鸣），然后正常启动系统。

### Q: 如何取消唤醒任务？
A: 运行脚本选择选项4，或在任务计划程序中删除"SystemAutoWake"任务。

### Q: 脚本安全吗？
A: 是的，脚本只使用Windows内置功能，不涉及网络操作或文件修改，源代码完全开放。

### Q: 支持虚拟机环境吗？
A: 支持但有限制，需要确保虚拟机支持RTC Alarm功能。

## 📞 获取帮助

如果您遇到问题：

1. **查看系统诊断**：运行脚本选择选项6
2. **检查文档**：查看README.md和CHANGELOG.md
3. **报告问题**：在GitHub创建Issue
4. **参与讨论**：在GitHub Discussions中提问

---

**提示**：首次使用建议在测试环境中验证唤醒功能，确保系统配置正确。
